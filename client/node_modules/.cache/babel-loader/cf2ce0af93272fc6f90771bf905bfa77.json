{"ast":null,"code":"var _jsxFileName = \"/Users/jaleelbennett/Documents/Projects/Block Watch - YT Watch Party/Youtube-Watch-Party/client/src/context/ConversationContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useContext, useState, createContext, useRef, useEffect } from 'react';\nimport { ParticipantContext } from './ParticipantContext';\nimport { useSocketContext } from './SocketContext'; // import io from 'socket.io-client';\n// const socket = io.connect('http://localhost:4000');\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ConversationPropsContext = /*#__PURE__*/createContext();\nexport function useConversationContext() {\n  _s();\n\n  return useContext(ConversationPropsContext);\n}\n\n_s(useConversationContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\n;\nexport function ConversationPropsProvider(_ref) {\n  _s2();\n\n  let {\n    children\n  } = _ref;\n  const socket = useSocketContext();\n  const [showChat, setShowChat] = useState(true);\n  const [chat, setChat] = useState([]);\n  const [userMessage, setUserMessage] = useState('');\n  const {\n    name\n  } = useContext(ParticipantContext);\n  const inputRef = useRef(null);\n\n  const getUserInput = e => setUserMessage(e.target.value);\n\n  const addSystemMessage = message => {\n    if (message) {\n      //displays message for all users\n      setChat([...chat, message]);\n    }\n  };\n\n  const addUserMessage = messageData => {\n    // if(messageData){\n    //   //displays message for all users\n    //   setChat([\n    //     ...chat, messageData\n    //   ])\n    // }\n    if (messageData) {\n      // if(chat.length >= 1){\n      const newChat = [...chat, messageData];\n      console.log(newChat);\n      setChat(newChat); // setChat( prevChat => {\n      //     const newChat = prevChat.map((message)=>{\n      //         return {\n      //             ...message, messageData\n      //         }\n      //     })\n      //     return newChat;\n      // })\n    } // console.log(chat)\n\n  };\n\n  const emitMessage = () => {\n    if (userMessage !== '') {\n      const messageData = {\n        sender: name,\n        message: userMessage\n      }; //sends message to server\n\n      socket.emit('chat_message', messageData);\n    }\n\n    setUserMessage('');\n    inputRef.current.value = \"\";\n  };\n\n  useEffect(() => {\n    console.log(chat);\n  }, [chat]);\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('system_message', message => {\n      // setChat([ ...chat, message ])\n      addSystemMessage(message);\n    });\n    socket.on(\"receive_chat_message\", data => {\n      addUserMessage(data);\n    });\n    socket.on(\"user_connected\", name => {\n      addSystemMessage(`${name} has joined the party`);\n    });\n    return () => {\n      socket.off('recieve_message');\n      socket.off('system_message');\n      socket.off('user_connected');\n    };\n  }, [socket]);\n  const conversationProps = {\n    showChat,\n    setShowChat,\n    chat,\n    setChat,\n    userMessage,\n    setUserMessage,\n    emitMessage,\n    addUserMessage,\n    addSystemMessage,\n    inputRef,\n    getUserInput //socket\n\n  };\n  return /*#__PURE__*/_jsxDEV(ConversationPropsContext.Provider, {\n    value: {\n      conversationProps\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(ConversationPropsProvider, \"mqP/XGCk5rM6JDqSwFjkmMMHQ1M=\", false, function () {\n  return [useSocketContext];\n});\n\n_c = ConversationPropsProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ConversationPropsProvider\");","map":{"version":3,"names":["useContext","useState","createContext","useRef","useEffect","ParticipantContext","useSocketContext","ConversationPropsContext","useConversationContext","ConversationPropsProvider","children","socket","showChat","setShowChat","chat","setChat","userMessage","setUserMessage","name","inputRef","getUserInput","e","target","value","addSystemMessage","message","addUserMessage","messageData","newChat","console","log","emitMessage","sender","emit","current","on","data","off","conversationProps"],"sources":["/Users/jaleelbennett/Documents/Projects/Block Watch - YT Watch Party/Youtube-Watch-Party/client/src/context/ConversationContext.js"],"sourcesContent":["import {useContext, useState, createContext, useRef, useEffect} from 'react';\nimport { ParticipantContext } from './ParticipantContext';\nimport { useSocketContext } from './SocketContext';\n// import io from 'socket.io-client';\n\n// const socket = io.connect('http://localhost:4000');\n\n\nconst ConversationPropsContext = createContext();\n\nexport function useConversationContext(){\n    return useContext(ConversationPropsContext)\n};\n\nexport function ConversationPropsProvider({children}){\n\n    const socket = useSocketContext();\n\n    const [showChat, setShowChat] = useState(true);\n\n    const [ chat, setChat ] = useState([]);\n    const [ userMessage, setUserMessage ] = useState('');\n\n    const {name} = useContext(ParticipantContext);\n\n    const inputRef = useRef(null);\n    \n    const getUserInput = (e) => setUserMessage(e.target.value);\n\n    const addSystemMessage =  (message) => {   \n        if(message){\n          //displays message for all users\n          setChat([\n            ...chat, message\n          ])\n        }\n    };\n\n    const addUserMessage = (messageData) => {   \n        // if(messageData){\n        //   //displays message for all users\n        //   setChat([\n        //     ...chat, messageData\n        //   ])\n        // }\n        if(messageData){\n            // if(chat.length >= 1){\n                const newChat = [...chat, messageData];\n                console.log(newChat)\n                setChat(newChat)\n                // setChat( prevChat => {\n                    \n                //     const newChat = prevChat.map((message)=>{\n                //         return {\n                //             ...message, messageData\n                //         }\n                //     })\n\n                //     return newChat;\n                // })\n\n        }\n\n        // console.log(chat)\n        \n    };\n\n    const emitMessage = () => {\n    \n        if(userMessage !== ''){\n\n            const messageData = {\n                sender: name,\n                message: userMessage\n            }\n\n            //sends message to server\n            socket.emit('chat_message', messageData);\n        }\n\n        setUserMessage('');\n        inputRef.current.value = \"\";\n        \n    };\n    useEffect(()=>{\n        console.log(chat)\n    }, [chat])\n\n    useEffect(()=>{\n\n        if(!socket) return;\n\n        socket.on('system_message', (message)=>{\n            // setChat([ ...chat, message ])\n            addSystemMessage(message);\n        })\n\n        socket.on(\"receive_chat_message\", (data) =>{\n            addUserMessage(data)\n        })\n      \n        socket.on(\"user_connected\", (name) =>{\n            addSystemMessage(`${name} has joined the party`)\n        })\n      \n        return () => {\n            socket.off('recieve_message');\n            socket.off('system_message');\n            socket.off('user_connected');\n        }\n\n    },[socket])\n\n\n\n    const conversationProps = {\n        showChat, setShowChat,\n        chat, setChat,\n        userMessage, setUserMessage,\n        emitMessage, addUserMessage,\n        addSystemMessage, inputRef,\n        getUserInput\n        //socket\n    };\n\n    return (\n        <ConversationPropsContext.Provider value={{conversationProps}}>\n            {children}\n        </ConversationPropsContext.Provider>\n    );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}